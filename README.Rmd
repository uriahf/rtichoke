---
output: github_document
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

```{r eval=FALSE, include=FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```

# rtichoke

<!-- badges: start -->
[![R-CMD-check](https://github.com/uriahf/rtichoke/workflows/R-CMD-check/badge.svg)](https://github.com/uriahf/rtichoke/actions)
[![CRAN status](https://www.r-pkg.org/badges/version/rtichoke)](https://CRAN.R-project.org/package=rtichoke)
[![Lifecycle: experimental](https://img.shields.io/badge/lifecycle-experimental-orange.svg)](https://lifecycle.r-lib.org/articles/stages.html#experimental)
[![Codecov test coverage](https://codecov.io/gh/uriahf/rtichoke/branch/main/graph/badge.svg)](https://codecov.io/gh/uriahf/rtichoke?branch=main)
<!-- badges: end -->

## Installation 

<!-- You can install the released version of rtichoke from [CRAN](https://CRAN.R-project.org) with: -->

<!-- ``` r -->
<!-- install.packages("rtichoke") -->
<!-- ``` -->

You can install rtichoke from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("uriahf/rtichoke")
```
<!-- TODO change to good model, bad model and random guess -->
## Overview: 

rtichoke is a package designed for interactive visualization for performance metrics of prediction models with a binary outcome.

## Getting started

### Predictions and Outcomes

In order to use rtichoke you need to have 

- `probs`: Estimated Probabilities as predictions ($0 \leq\hat{p} \leq 1$).
- `real`: Binary Outcomes ($yâˆˆ\{1, 0\}$). 

There are 3 different cases and for each one of them rtichoke requires a different kind of input:

## One model for One Population: 

**Why?** 
In order to examine performance of a single model for one population.

**How?**
The user is required to provide one vector for the model's predictions and one vector for the outcome of the population.

```{r echo=FALSE}

library(rtichoke)
set.seed(42)

predictions_and_outcomes <- tibble::tibble(
  probs = example_dat$bad_model,
  real = rtichoke::example_dat$outcome) 


predictions_and_outcomes %>% 
  dplyr::sample_n(replace = FALSE, size = 6) %>% 
  gt::gt()
```


```{r eval=FALSE, include=TRUE}

create_roc_curve(probs = example_dat$bad_model,
                 real = example_dat$outcome,
                 interactive = TRUE)
```

Alternatively the vector of the model predictions can be in a list:

```{r eval=FALSE, include=FALSE}
create_roc_curve(probs = list("Bad Model" = 
                   example_dat$bad_model),
                 real = example_dat$outcome,
                 interactive = TRUE)
```


## Several Models for One Population 

**Why?** 
In order to compare performance for three different models for the same population.

**How?** 
The user is required to provide one vector of predictions for each model in a list and one vector for the outcome of the population.


```{r echo=FALSE}

library(rtichoke)
set.seed(42)

predictions_and_outcomes <- tibble::tibble(
    "Good Model" = example_dat$estimated_probabilities,
    "Bad Model" = example_dat$bad_model,
    "Random Guess" = example_dat$random_guess,
  real = rtichoke::example_dat$outcome) 


predictions_and_outcomes %>% 
  dplyr::sample_n(replace = FALSE, size = 6) %>% 
  gt::gt()
```


```{r eval=FALSE, include=FALSE}
create_roc_curve(
  probs = list(
    "Good Model" = example_dat$estimated_probabilities,
    "Bad Model" = example_dat$bad_model,
    "Random Guess" = example_dat$random_guess
  ),
  real = example_dat$outcome,
  interactive = TRUE
)

```






```{r eval=FALSE, include=FALSE}

create_roc_curve(probs = list(
  "Logistic Regression" = logistic_preds_train,
  "Decision Tree" = tree_preds_train,
  "Random Guess" = random_preds_train),
                 real = survived_train,
                 interactive = TRUE)

```


## Several Populations 

*Why?* 
In order to compare performance for different populations, like in Train / Test
split or in order to check the fairness of the algorithms.

*How?* 
The user is required to provide one vector of predictions for each population in a list and one vector for each outcome of the population in another list.


```{r echo=FALSE}

library(rtichoke)
set.seed(42)

predictions_and_outcomes_train <- tibble::tibble(
    "probs" = example_dat %>%
      dplyr::filter(type_of_set == "train") %>%
      dplyr::pull(estimated_probabilities),
  real = example_dat %>% dplyr::filter(type_of_set == "train") %>%
      dplyr::pull(outcome))  

predictions_and_outcomes_test <- tibble::tibble(
    "probs" = example_dat %>%
      dplyr::filter(type_of_set == "test") %>%
      dplyr::pull(estimated_probabilities),
  real = example_dat %>% dplyr::filter(type_of_set == "test") %>%
      dplyr::pull(outcome))  



predictions_and_outcomes_train %>% 
  dplyr::sample_n(replace = FALSE, size = 6) %>% 
  gt::gt() %>%
  gt::tab_header(
    title = gt::md("**Train Set**")
  )


predictions_and_outcomes_test %>% 
  dplyr::sample_n(replace = FALSE, size = 6) %>% 
  gt::gt() %>%
  gt::tab_header(
    title = gt::md("**Test Set**")
  )

```


```{r eval=FALSE, include=FALSE}

create_roc_curve(
  probs = list(
    "Train" = example_dat %>%
      dplyr::filter(type_of_set == "train") %>%
      dplyr::pull(estimated_probabilities),
    "Test" = example_dat %>% dplyr::filter(type_of_set == "test") %>%
      dplyr::pull(estimated_probabilities)
  ),
  real = list(
    "Train" = example_dat %>% dplyr::filter(type_of_set == "train") %>%
      dplyr::pull(outcome),
    "Test" = example_dat %>% dplyr::filter(type_of_set == "test") %>%
      dplyr::pull(outcome)
  ),
  interactive = TRUE
)

```



### Performance Data

For roc, lift, precision recall, gains and decision curves and for performance table you can alternatively prepare a performance data and use it as an input, but instead of create_*_curve use plot_*_curve and instead of create_performance_table use render_performance_table:
(gif render_roc_curve, prepare_performance_table, plot_roc_curve)
(table of inputs)


### Summary Report 

In order to get all the supported outputs of rtichoke in one html file the user can call create_summary_report().

### Getting help

If you encounter a bug please fill an issue with a minimal reproducible example, it will be easier for me to help you and it might help others in the future. Alternatively you are welcome to contact me personally: ufinkel@gmail.com

